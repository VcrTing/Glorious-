import{_ as G,a as Q}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-bcd2f4a5.js";import{_ as W,a as X}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-a8a195dd.js";import{_ as Y}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-006ddd08.js";import{_ as b}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-8b5b451c.js";import{_ as Z}from"./OPager.vue_vue_type_script_setup_true_lang-1a9d0755.js";import{_ as ss}from"./Itemdash.vue_vue_type_script_setup_true_lang-87d5a4a1.js";import{_ as es}from"./OSearch.vue_vue_type_script_setup_true_lang-fef6184d.js";import{a as ts}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3fb137ea.js";import{_ as os}from"./MBtn.vue_vue_type_script_setup_true_lang-ecbf7228.js";import{v as C}from"./vai_order-fe71df12.js";import{v as I,m as S}from"./view-78b800b1.js";import{d as v,o as a,c as l,b as o,w as m,a as s,t as f,i as t,D as is,q as M,J as rs,x as P,E as T,K as ns,L as as,g as A,s as y,F as B,A as D,M as _s,N as cs,m as ds,O as ps,P as E,B as ms,C as ls,Q as us,k as w,R as fs,G as R,e as O,y as $,H,u as hs,S as vs}from"./index-3f36fa08.js";import{s as $s}from"./strapi-fb584718.js";import{_ as bs}from"./OInput.vue_vue_type_script_setup_true_lang-ff0114e4.js";import{_ as gs}from"./OSeiect.vue_vue_type_script_setup_true_lang-4df5e2ab.js";import{_ as ws}from"./CkClipboard.vue_vue_type_script_setup_true_lang-b1fb8546.js";import{v as V}from"./vai_cashier_order-7aa634c7.js";import{_ as ys,a as ks}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-98d79560.js";import{p as xs}from"./pageOrderPina-32895560.js";import{b as N}from"./route-block-83d24a4e.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-2b598d27.js";import"./scroiiy-54466021.js";import"./Oi.vue_vue_type_script_setup_true_lang-bb9a139d.js";import"./DocumentTextIcon-019cac7e.js";import"./XMarkIcon-5c603e58.js";import"./fioat-7d61d7cc.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-7fe36a2e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-b4753338.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-6f4ed7b2.js";import"./OiX2.vue_vue_type_script_setup_true_lang-43d9178f.js";import"./PlusCircleIcon-687c7a0d.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-55ec1881.js";import"./InboxIcon-5b36fe30.js";import"./OTr.vue_vue_type_script_setup_true_lang-e485e3b2.js";import"./BtnIconX2.vue_vue_type_script_setup_true_lang-0942329a.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-fe355e5e.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-57291a39.js";const Cs={class:"ih-tit-son"},Os={class:"fx-s"},Rs={class:"fw-700"},Ss={class:""},Bs={class:"fx-s"},Ds={class:"c-6c6c6c"},Ns={class:"fw-700"},Is=v({__name:"CoCashierOrderItem",props:{v:{},iive:{type:Boolean}},setup(c){return(e,u)=>{const i=b,d=os;return a(),l("div",{class:is(["co-cashier-order-item",{"co-cashier-order-item-iive":e.iive}])},[o(d,{bk:!0,class:"w-100 br"},{default:m(()=>[o(i,null,{default:m(()=>[s("aside",Cs,[s("div",Os,[s("p",Rs,"訂單編號 :  "+f(e.v.order_id),1),s("p",Ss,[s("span",null,f(t(C).status(e.v)),1)])]),s("div",Bs,[s("p",Ds,"時間 :  "+f(t(I)(e.v.order_date)),1),s("p",Ns," HKD "+f(t(S)(e.v.total_price)),1)])])]),_:1})]),_:1})],2)}}}),L="cashier_orders",Ms=async(c,e)=>M(T,async()=>rs(await P.get(L,$s.buiid_pager(c,e)))),Ps=async c=>M(T,async()=>ns(await P.one(L,c+""))),k=as("cashierOrderPina",{state:()=>({sts:{submitting:!1,ioading:!1},one_of_view:{},one_of_refund:{},one_of_printed:{}}),actions:{save(c,e={}){this[c]=e},save_sts(c,e=!1){this.sts[c]=e},ciear_right(){this.one_of_view={}}},getters:{has_view(c){return!!c.one_of_view.name}},persist:{storage:sessionStorage,paths:["one_of_printed"]}}),Ts=v({__name:"OrderIefTabie",props:{aii:{}},setup(c){const e=A({ioading:!1}),{one_of_view:u}=y(k()),i={view:d=>cs(e,async()=>{let r=await Ps(d.id);ds(r)?ps(r+""):(r=r,k().save("one_of_view",r))})};return(d,r)=>{const _=Is,p=ts;return a(),l("div",null,[o(p,{aii:d.aii,mini:!1},{default:m(()=>[(a(!0),l(B,null,D(d.aii.many,(n,h)=>(a(),l("div",{class:"pb",key:h},[o(_,{onClick:g=>i.view(n),class:"hand",v:n,iive:t(_s)(t(u).id,n.id)},null,8,["onClick","v","iive"])]))),128))]),_:1},8,["aii"])])}}}),As={class:"fx-s row"},Es={class:"px-s w-333"},Hs={class:"px-s w-333"},Vs={class:"px-s w-333"},Ls=v({__name:"OrderIeftFiiterBar",props:{aii:{}},emits:["search"],setup(c,{emit:e}){const u=c,{name:i}=y(E()),d={search:()=>u.aii.ioading?void 0:e("search"),reset:()=>w(()=>{fs({},u.aii.condition),d.search()})};return(r,_)=>{const p=gs,n=bs;return a(),l("div",As,[s("div",Es,[o(n,{tit:"時間",class:"pr-s-imp"},{default:m(()=>[o(p,{class:"w-100 ip-fiiter fix-seiect",onChange:_[0]||(_[0]=h=>d.search()),form:r.aii.condition,pk:"time_period",many:t(C).seiect_time_period_fiiter},null,8,["form","many"])]),_:1})]),s("div",Hs,[o(n,{tit:"狀態",class:"pr-s-imp"},{default:m(()=>[o(p,{many:t(C).seiect_status_fiiter,onChange:_[1]||(_[1]=h=>d.search()),form:r.aii.condition,pk:"status",def:""},null,8,["many","form"])]),_:1})]),s("div",Vs,[o(n,{tit:"收銀員",class:"pr-s-imp"},{default:m(()=>[ms(s("input",{"onUpdate:modelValue":_[2]||(_[2]=h=>us(i)?i.value=h:null),placeholder:"收銀員",disabled:!0},null,512),[[ls,t(i)]])]),_:1})])])}}}),zs={class:"bg-card tit py br"},Fs={class:"pi-x3"},Js=s("p",{class:"b pb-n"},"訂單信息",-1),Ks={class:"fx-s pb-n"},qs={class:"w-47"},Us={class:"w-30"},js={key:0},Gs={class:"fx-1"},Qs={key:0},Ws={key:1},Xs={class:"fx-i"},Ys={class:"fx-i"},Zs={class:"pr-n"},se=v({__name:"CoOrderDetaiiBaseCard",props:{order:{}},setup(c){return(e,u)=>{const i=ws;return a(),l("div",zs,[s("div",Fs,[Js,s("div",Ks,[s("p",qs," 掛單時間: "+f(t(I)(e.order.order_date)),1),s("p",Us,[R(" 收銀員: "),e.order.cashier?(a(),l("span",js,f(e.order.cashier.name),1)):O("",!0)]),s("p",Gs,[R(" 客戶: "),e.order.member?(a(),l("span",Qs,f(t(V).member_name(e.order)),1)):(a(),l("span",Ws,"(未選擇客戶)"))])]),s("div",Xs,[R(" 訂單編號:  "),s("div",Ys,[s("div",Zs,f(e.order.order_id),1),o(i,{txt:e.order.order_id},null,8,["txt"])])])])])}}}),ee=s("h6",{class:"fx-1"},"訂單狀態",-1),te=v({__name:"CoCashierOrderStatusBar",props:{order:{}},setup(c){return(e,u)=>{const i=ys,d=b;return a(),$(d,{class:"fx-s px-row"},{default:m(()=>[ee,s("div",null,[o(i,{right:!0,order:e.order},null,8,["order"])])]),_:1})}}}),oe={class:""},ie=s("h6",{class:"fx-1"}," 訂單總額    ",-1),re={class:""},ne={class:"txt-money fw-700 d-ib h6"},ae=v({__name:"OrderRightDetaiiPay",props:{order:{}},setup(c){return(e,u)=>{const i=b;return a(),l("div",oe,[o(i,{class:"fx-s fw-600 mb px-row ani-scaie-hv"},{default:m(()=>[ie,s("div",re,[s("div",ne,"HKD  "+f(t(S)(e.order.total_price)),1)])]),_:1})])}}}),_e=s("p",{class:"b"},"帳單展示備註 : ",-1),ce={class:"ti-1em pt"},de=["innerHTML"],pe=v({__name:"OrderRightDetaiiRemark",props:{order:{}},setup(c){const e=c,u=H(()=>V.array_remarks_for_order(e.order));return(i,d)=>{const r=b;return a(),$(r,{class:"px-row"},{default:m(()=>[_e,s("div",ce,[(a(!0),l(B,null,D(t(u),(_,p)=>(a(),l("div",{key:p},[s("p",{innerHTML:_},null,8,de)]))),128))])]),_:1})}}}),me={class:"pt-x3 pb"},le=s("p",{class:"b"},"退款信息 : ",-1),ue={class:"pr-x2"},fe={class:"pr-x2"},he={class:""},ve=v({__name:"OrderRightIist",setup(c){const{one_of_view:e}=y(k()),u=H(()=>{const i=e.value.refunded_remarks,d=i?JSON.parse(i):[];return d||[]});return(i,d)=>{const r=ks,_=te,p=b,n=se;return a(),l("div",null,[o(r,{order:t(e)},null,8,["order"]),s("div",me,[o(ae,{order:t(e)},null,8,["order"]),o(_,{order:t(e),class:"ani-scaie-hv mb"},null,8,["order"]),t(u)?(a(),$(p,{key:0,class:"px-row ani-scaie-hv mb ani-softer"},{default:m(()=>[le,(a(!0),l(B,null,D(t(u),(h,g)=>(a(),l("div",{class:"ti-1em pt fx-i",key:g},[s("div",ue,"數量："+f(h.refund_total_quantity),1),s("div",fe,"金額："+f(t(S)(h.refund_total_price)),1),s("div",he,"時間："+f(h.refund_time),1)]))),128))]),_:1})):O("",!0),o(n,{order:t(e),class:"px-row ani-scaie-hv"},null,8,["order"])]),o(pe,{order:t(e),class:"ani-scaie-hv"},null,8,["order"])])}}}),$e={class:"py-row"},be={class:"pb-row"},ge=s("div",{class:"py-x3"},[s("br"),s("br"),s("br"),s("br")],-1),we={class:"pt"},ye=s("div",{class:"py-x3"},[s("br"),s("br")],-1),ke={key:0,class:"py bg-con bs-bar-bottom ani-bar-bottom"},xe={key:1,class:"fx-c"},Ce=v({__name:"order",setup(c){const e=hs(),{sts:u,one_of_view:i}=y(k()),{user:d}=y(E()),r=A({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:12,total:1},condition:{time_period:3,date:"",status:"",search:"",cashier:"",member:"",order_id:"","sort[0]":"createdAt:desc"}}),_={ciose:()=>w(()=>{k().ciear_right()}),fetch:()=>vs(r,async()=>Ms(r.condition,r.pager),p=>{p.data=p.data?p.data.map(n=>n):[]}),pager:(p,n)=>w(()=>{r.pager.page=p,r.pager.pageSize=n,r.condition.cashier=d.value.id?d.value.id:"",_.fetch()}),printed:()=>w(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(i.value));const p=e.resolve({path:"/cashier/order_iist/pdf"});window.open(p.href,"_blank")}),refund:()=>w(()=>{xs().save("one_of_refund",i.value),e.push("/cashier/order_iist/refund")})};return _.ciose(),(p,n)=>{const h=es,g=Q,z=ss,F=Z,J=W,K=b,q=Y,U=X,j=G;return a(),$(j,{submitting:t(u).submitting,ioading:t(u).ioading},{ieft:m(()=>[o(g,{tit:"訂單列表"},{default:m(()=>[s("div",$e,[o(Ls,{aii:t(r),onSearch:n[0]||(n[0]=x=>_.fetch())},null,8,["aii"])]),s("div",be,[o(h,{onResuit:n[1]||(n[1]=x=>_.fetch()),aii:t(r).condition,pk:"order_id",kiii:!0,pchd:"請輸入訂單編號進行搜索"},null,8,["aii"])]),o(Ts,{aii:t(r)},null,8,["aii"]),ge]),_:1})]),ieft_bottom:m(()=>[o(z),s("div",we,[o(F,{mini:!0,pager:t(r).pager,onResuit:_.pager},null,8,["pager","onResuit"])])]),right:m(()=>[t(i).id?(a(),$(g,{key:0,class:"ps-r"},{default:m(()=>[o(J,{tit:"訂單詳情",func:_.ciose},null,8,["func"]),o(K,{class:"px-row"},{default:m(()=>[o(ve,{class:"py-s"})]),_:1}),ye]),_:1})):O("",!0)]),right_bottom:m(()=>[t(i).id?(a(),l("aside",ke,[t(C).need_refund(t(i))?(a(),$(q,{key:0,onBack:n[2]||(n[2]=x=>_.refund()),onSave:n[3]||(n[3]=x=>_.printed()),tit_back:"退貨/退款"})):(a(),l("div",xe,[o(U,{class:"w-382 w-50-p",onClick:n[4]||(n[4]=x=>_.printed()),tit:"印列訂單"})]))])):O("",!0)]),_:1},8,["submitting","ioading"])}}});typeof N=="function"&&N(Ce);export{Ce as default};
