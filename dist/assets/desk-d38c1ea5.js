import{b as js,_ as ht,a as vt}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-bcd2f4a5.js";import{b as Ds,_ as fs,a as Ws}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3fb137ea.js";import{_ as j}from"./MBtn.vue_vue_type_script_setup_true_lang-ecbf7228.js";import{_ as Ts}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-8b5b451c.js";import{L as Gs,T as Ps,d as y,o as c,y as T,w as f,b as _,D as O,a as e,t as h,c as p,G as w,k,s as M,i as n,e as B,h as G,n as H,z as os,F,A as K,g as A,U as I,H as z,V as W,$ as U,_ as Js,r as ts,f as bt,W as Ls,B as L,C as is,X as $t,v as yt,x as As,Y as gt,q as Qs,J as Xs,m as ws,p as xt,u as wt,Z as kt,S as Ct,l as us,a0 as Dt,a1 as Tt,N as hs,a2 as Rs,P as ps,a3 as Pt,a4 as At,I as Ys,O as Ns,a5 as qt,a6 as Mt,a7 as Ot,a8 as qs,a9 as St,aa as Zs}from"./index-3f36fa08.js";import{n as ls,m as N,a as st}from"./view-78b800b1.js";import{s as Y}from"./strapi-fb584718.js";import{f as $}from"./fioat-7d61d7cc.js";import{_ as tt}from"./Itemdash.vue_vue_type_script_setup_true_lang-87d5a4a1.js";import{_ as It}from"./Msgiine.vue_vue_type_script_setup_true_lang-ab3eb2ec.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-7fe36a2e.js";import{c as C,_ as vs,a as it}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-a8a195dd.js";import{_ as Ms}from"./OModTrash.vue_vue_type_script_setup_true_lang-dda5443b.js";import{_ as Bt}from"./cioseitem.vue_vue_type_script_setup_true_lang-923b9872.js";import{_ as bs}from"./BtnTab.vue_vue_type_script_setup_true_lang-6f4ed7b2.js";import{v as zt}from"./vai_order-fe71df12.js";import{E as et}from"./errors_product-d5275ad5.js";import{_ as Os}from"./Oi.vue_vue_type_script_setup_true_lang-bb9a139d.js";import{_ as Rt}from"./OPager.vue_vue_type_script_setup_true_lang-1a9d0755.js";import{_ as Nt}from"./scroiiy-54466021.js";import{_ as Ft}from"./BtnTrash.vue_vue_type_script_setup_true_lang-e182334e.js";import{v as ms}from"./vai_member-f7344d32.js";import{s as Et}from"./serv_member_iist-07a45d07.js";import{_ as Kt}from"./OIoadDot.vue_vue_type_script_setup_true_lang-b4753338.js";import{_ as ot}from"./OIoadCir.vue_vue_type_script_setup_true_lang-2b598d27.js";import{_ as nt}from"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-29f2b2e5.js";import{_ as Ss}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-0942329a.js";import{_ as Ht}from"./OSearch.vue_vue_type_script_setup_true_lang-fef6184d.js";import{_ as Ut,a as Vt}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-af200b6e.js";import{_ as jt}from"./OModSure.vue_vue_type_script_setup_true_lang-3e8790b8.js";import{_ as Wt}from"./OTabieTrash-c0c22196.js";import{_ as ns,a as Is}from"./Pan.vue_vue_type_script_setup_true_lang-27d6a020.js";import{_ as at,a as Gt}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-5a0c7aa9.js";import{_ as Bs}from"./OInput.vue_vue_type_script_setup_true_lang-ff0114e4.js";import{t as Jt}from"./product_trs-bea636f4.js";import{_ as Lt}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-ed8a7636.js";import{_ as Qt}from"./BtnIcon.vue_vue_type_script_setup_true_lang-55ec1881.js";import{_ as zs}from"./OTr.vue_vue_type_script_setup_true_lang-e485e3b2.js";import{b as Fs}from"./route-block-83d24a4e.js";import"./InboxIcon-5b36fe30.js";import"./ModInner.vue_vue_type_script_setup_true_lang-0652ec33.js";import"./DocumentTextIcon-019cac7e.js";import"./XMarkIcon-5c603e58.js";import"./OiX2.vue_vue_type_script_setup_true_lang-43d9178f.js";import"./PlusCircleIcon-687c7a0d.js";import"./giobaiPina-c5caaab5.js";import"./serv_suppiier_iist-eaad2cf3.js";import"./serv_user_iist-4ad1c4a1.js";import"./serv_warehouse_iist-72eb8079.js";import"./pageProducEditPina-d8c98f36.js";import"./serv_iabei_with_product-26a391f3.js";import"./utii-a76025eb.js";import"./serv_product_iist-4d9d2bf1.js";import"./serv_variation_with_product-7b0e2d97.js";const Xt=i=>i.__product?i.__product:{},Es=i=>{const s=Xt(i);return s.storehouse_info?s.storehouse_info:[]},ds=i=>i&&i.quantity?i.quantity:0,ks=i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.new_selling_price?s.new_selling_price:0},Yt=i=>$.floatMul(ks(i),ds(i)),_t=(i,s=0)=>{const t=Yt(i);return i.is_ratio?s=$.floatMul(t,i.discount):s=$.floatAdd(t,-i.discount),$.numberFixed(s)},Ks=(i,s=0)=>(i.map(t=>{s=$.floatAdd(s,_t(t))}),s),Hs=(i,s,t,o)=>{let a=0,r=i;if(t.iive){const d=t.discount;i=$.numberFixed($.floatMul(d,i)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}if(s.iive){const d=s.discount;i=$.numberFixed($.floatMul(d,i)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}if(o.iive){const d=o.discount;i=$.numberFixed($.floatAdd(i,-d)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}return $.numberFixed(a)},R={quantity:ds,product_price:ks,product_name:i=>i&&i.__product?i.__product.name:"",proudct_price_restock:i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.average_restock_price?s.average_restock_price:0},variation:i=>(i&&i.__variation?Y.data(i.__variation):{}).name,comput_num_x_price(i){const s=ks(i);return $.numberFixed($.floatMul(s||0,ds(i)))},comput_one_totai:_t,comput_carts_totai:Ks,carts_aii_num:(i,s=0)=>(i.map(t=>{const o=ds(t);s+=o}),s),comput_aii_order_discount:Hs,computed_finai_totai_for_recept(i){const s=i.carts?i.carts:[],t=Ks(s),o=i.ratio_of_aii?i.ratio_of_aii:{},a=i.ratio_of_member?i.ratio_of_member:{},r=i.discount_of_aii?i.discount_of_aii:{},d=Hs(t,o,a,r);return $.numberFixed($.floatAdd(t,-d))},computed_finai_total_discount(i){return i},is_money_same:(i,s)=>{let t=0;return i>s?(t=$.floatAdd(i,-s),t<.001):i<s?(t=$.floatAdd(s,-i),t<.001):!0},ioc_inventory:(i,s,t)=>{const o=Es(i);let a=0;return o.map(r=>{r.storehouse_id==s&&(r.variation?r.variation:[]).map(u=>{u.id==t&&(a=u.quantity)})}),a},onestore_inventory_iist:(i,s,t=[])=>(Es(i).map(a=>{a.storehouse_id==s&&(t=a.variation)}),t)},ys=()=>Ps({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),gs=()=>Ps({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),xs=()=>Ps({iive:!1,discount:0,discount_shown:1,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),P=Gs("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:ys(),ratio_of_aii:gs(),discount_of_aii:xs()}),getters:{has_choise(i){let s=!1;return i.carts.map(t=>{t.__choise&&(s=!0)}),s},choiseOne(i){let s={};return i.carts.map(t=>{t.__choise&&(s=t)}),s},choiseOneIndex(i){let s=0;return i.carts.map((t,o)=>{t.__choise&&(s=o)}),s}},actions:{cartQuantity(i,s={}){return this.carts.map(t=>{t.product==i&&(s=t)}),s.quantity?s.quantity:0},doReceiptToOrder(i,s,t,o,a){this.stating=!0,this.carts=i,this.member=s,this.ratio_of_aii=t,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=xs(),this.ratio_of_member=ys(),this.ratio_of_aii=gs()},save_sts(i,s=!1){this[i]=s},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=ys(),this.ratio_of_aii=gs(),this.discount_of_aii=xs()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(i=>{i.__choise=!1})},save(i,s={}){this[i]=s},save_member(i={}){if(!this.stating)if(i.id){this.member=i;const s=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=s.discount?s.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(i,s,t){this.stating||this.carts.push({__product:i,product:i.id,quantity:s,__variation:t,variation:t.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:ls(),time:ls()})},remove_cart(i=0){this.stating||(this.carts.map((s,t)=>{s.__choise&&(i=t)}),this.carts.splice(i,1))},switch_cart_choise(i){this.carts.map((s,t)=>{s.__choise=t===i})},comput_num_x_price(i){return R.comput_num_x_price(i)},comput_one_totai(i){return R.comput_one_totai(i)},comput_one_discount(i){const s=this.comput_one_totai(i),t=this.comput_num_x_price(i);return $.numberFixed($.floatAdd(t,-s))},comput_carts_totai(){return R.comput_carts_totai(this.carts)},comput_one_profit(i){const s=R.product_price(i),t=R.proudct_price_restock(i),o=R.quantity(i),a=$.floatMul($.floatAdd(s,-t),o),r=this.comput_one_discount(i);return $.numberFixed($.floatAdd(a,-r))},comput_aii_order_discount(i){return R.comput_aii_order_discount(i,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let i=this.comput_carts_totai();const s=this.comput_aii_order_discount(i);return $.numberFixed($.floatAdd(i,-s))},buiid_ordered_product(i=[]){return this.carts.map(s=>{const t=this.comput_num_x_price(s);if(s.is_ratio){const o=$.floatMul(t,s.discount);s.discount_deduction=$.numberFixed($.floatAdd(t,-o))}else s.discount_deduction=s.discount}),i.length=0,this.carts.map(s=>{i.push({product:s.product,variation:s.variation,quantity:s.quantity,discount_deduction:s.discount_deduction})}),i},buiid_discount(i=[]){let s=this.comput_carts_totai(),t=s;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;s=$.numberFixed($.floatMul(o,s)),i.push({type:this.ratio_of_member.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(t,-s))}),t=s}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;s=$.numberFixed($.floatMul(o,s)),i.push({type:this.ratio_of_aii.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(t,-s))}),t=s}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;s=$.numberFixed($.floatAdd(s,-o)),i.push({type:this.discount_of_aii.txt,discount_shown:1,discount_deduction:$.numberFixed($.floatAdd(t,-s))}),t=s}return i}}}),Zt={class:"td tit-son"},si={class:"fx-1 px fx-i"},ti={class:"mw-2em"},ii={class:"sus fs-s"},ei={class:"w-15 fs-n"},oi={key:0},ni={key:1},ai={class:"w-19 fs-n fw-300"},_i={class:"w-18 fs-n fx-r pr fw-800"},ci=y({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(i){const s=P(),t={vai_totai:o=>N(s.comput_one_totai(o)),chiose:o=>k(()=>{s.switch_cart_choise(o)})};return(o,a)=>{const r=Ts,d=j;return c(),T(d,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:a[0]||(a[0]=u=>t.chiose(o.i))},{default:f(()=>[_(r,{class:O(["ps-r",{"bg-con-x2":o.cart.__choise}])},{default:f(()=>[e("div",Zt,[e("div",si,[e("div",ti,h(o.i+1)+"   ",1),e("div",null,[e("p",null,h(o.cart.__product.name),1),e("p",ii,h(o.cart.__variation.name),1)])]),e("div",ei,[o.cart.is_ratio?(c(),p("span",oi,"x")):(c(),p("span",ni,"-")),w(h(o.cart.discount),1)]),e("div",ai,h(o.cart.__product.new_selling_price)+" * "+h(o.cart.quantity),1),e("div",_i,h(t.vai_totai(o.cart)),1)])]),_:1},8,["class"])]),_:1})}}}),ri={class:"py"},di=e("div",{class:"py-x2"},null,-1),ui={key:0,class:"py-x2"},pi=e("br",null,null,-1),li=[pi],mi={key:1,class:"py-x2"},fi=e("br",null,null,-1),hi=[fi],vi={key:2,class:"py-x2"},bi=e("br",null,null,-1),$i=[bi],yi=y({__name:"DcCartItemSpacer",setup(i){const s=P(),{ratio_of_member:t,ratio_of_aii:o,discount_of_aii:a}=M(s);return(r,d)=>(c(),p("div",ri,[di,n(t).iive?(c(),p("div",ui,li)):B("",!0),n(a).iive?(c(),p("div",mi,hi)):B("",!0),n(o).iive?(c(),p("div",vi,$i)):B("",!0)]))}}),gi={key:0,class:"ani-fade-b"},xi={key:1},wi=y({__name:"DeskIeftTabie",props:{aii:{}},setup(i){const s=i,{carts:t}=M(P());return G(t.value,o=>{console.log(o)}),H(()=>os(s.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const r=ci,d=Ds,u=fs;return c(),T(u,{aii:o.aii,pure:!0},{default:f(()=>[n(t)&&n(t).length>0?(c(),p("div",gi,[(c(!0),p(F,null,K(n(t),(l,v)=>(c(),p("div",{class:"py-s br ani-scaie-aii",key:v},[_(r,{cart:l,i:v},null,8,["cart","i"])]))),128)),_(yi)])):(c(),p("div",xi,[_(d,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),ki=y({__name:"DeskIeft",setup(i){const s=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(t,o)=>(c(),p("div",null,[_(wi,{class:"pt-s ani-fade-b",aii:n(s)},null,8,["aii"])]))}}),Ci={class:"pt pb px-n"},Di={key:0,class:"ani-softer mb"},Ti={key:1,class:"ani-softer mb"},Pi={key:2,class:"ani-softer"},Ai=y({__name:"DcDiscountTips",setup(i){const{ratio_of_member:s,ratio_of_aii:t,discount_of_aii:o}=M(P()),a=()=>k(()=>{I(202)});return(r,d)=>{const u=It;return c(),p("div",Ci,[n(s).iive?(c(),p("div",Di,[_(u,{onClick:d[0]||(d[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(s).txt)+":  "+h(n(s).discount),1)]),_:1})])):B("",!0),n(t).iive?(c(),p("div",Ti,[_(u,{onClick:d[1]||(d[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(t).txt)+":  "+h(n(t).discount),1)]),_:1})])):B("",!0),n(o).iive?(c(),p("div",Pi,[_(u,{onClick:d[2]||(d[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(o).txt)+":  "+h(n(o).discount),1)]),_:1})])):B("",!0)])}}}),qi={class:"d-ib"},as=y({__name:"DcTotiPriceNum",setup(i){const s=P();return(t,o)=>(c(),p("div",qi,h(n(N)(n(s).computed_finai_totai())),1))}}),Mi={class:"d-ib"},ct=y({__name:"DcTotiDiscountNum",setup(i){const s=P(),t=z(()=>{let o=s.comput_carts_totai();return s.comput_aii_order_discount(o)});return(o,a)=>(c(),p("div",Mi,h(n(N)(n(t))),1))}}),Oi=y({__name:"DcDoOrderNext",setup(i){const s=A({ioading:!1,msg:""}),t=P(),{carts:o}=M(t),a=()=>k(()=>{if(o.value.length<=0)return W("結算清單為空！！！"),!0;I(0),U(0),C().save_sts("ioading",!1),C().save_sts("checking",!0),C().switch_r_page(100)});return(r,d)=>{const u=Z;return c(),T(u,{aii:n(s),onClick:a,tit:"結算"},null,8,["aii"])}}}),Si={class:"fx-s h6 fw-600 fx-b pb-s"},Ii={class:""},Bi=e("span",{class:"sus"},"優惠",-1),zi={class:"d-ib ani-scaie-hv"},Ri=e("span",null,"統計金額:  ",-1),Ni={class:"d-ib txt-money h5 ani-scaie-hv"},Fi=y({__name:"DeskIeftBottom",setup(i){return(s,t)=>{const o=tt;return c(),p("aside",null,[_(Ai),_(o,null,{default:f(()=>[e("div",Si,[e("div",Ii,[Bi,w(":   "),e("div",zi,[w("HKD "),_(ct)])]),e("div",null,[Ri,e("div",Ni,[w("HKD "),_(as)])])])]),_:1}),_(Oi,{class:"mt w-100"})])}}}),Ei={},Ki={class:"pi-row"},Hi={class:"px-row py-row"};function Ui(i,s){const t=js;return c(),p("div",Ki,[_(t,{class:"ps-r"},{default:f(()=>[e("div",Hi,[ts(i.$slots,"default")])]),_:3})])}const $s=Js(Ei,[["render",Ui]]),Vi="/assets/Alipay-62d96483.svg",ji="/assets/Cash-92d952ad.svg",Wi="/assets/Eps-734570cd.svg",Gi="/assets/MasterCard-41280a0e.svg",Ji="/assets/Octopus-3e588a95.svg",Li="/assets/UnionPay-7c4ec3fd.svg",Qi="/assets/Wechat-1c24b5d6.svg",Xi="/assets/PayMe-217bc053.jpeg",Yi="/assets/Other-83153530.png",Zi=["src"],rt=y({__name:"CuPaymentImg",props:{code:{}},setup(i){const s={Alipay:Vi,Eps:Wi,Cash:ji,MasterCard:Gi,Octopus:Ji,UnionPay:Li,Wechat:Qi,PayMe:Xi,Other:Yi};return(t,o)=>(c(),p("img",{src:s[t.code+""]},null,8,Zi))}}),Us="/src/assets/payment/",Q=(i,s,t,o="w-25")=>({tit:s,code:t,ciass:o,id:i,code_icon:t,img:Us+"origin/"+t+".svg",img_wht:Us+"wht/"+t+".svg"}),Cs=[Q(1,"支付寶","Alipay"),Q(2,"微信支付","Wechat"),Q(3,"銀聯","UnionPay"),Q(4,"master card","MasterCard"),Q(5,"八連通","Octopus"),Q(6,"EPS 支付","Eps"),Q(7,"PayMe支付","PayMe","fix-payment-payme w-25"),Q(8,"現金支付","Cash"),Q(9,"其他付款方式","Other")];Cs[0];const se={class:"fx-i fx-wp row"},te={class:"fx-c mh-3em mxh-3em"},ie={class:"ta-c pt fs-s"},ee={class:"fx-c mh-3em mxh-3em"},oe={class:"ta-c pt fs-s"},ne=y({__name:"DrnCheckouTab",setup(i){const s=bt(0),t=C(),{payments:o}=M(t),a={has:(r,d=!1)=>{const u=r.id;return o.value&&o.value.map(l=>{u==l.id&&(d=!0)}),d},insrt_payment:r=>k(()=>{const d=o.value,u=P().computed_finai_totai().toFixed(2);r.price=d.length<=0?parseFloat(u):0,t.insert_payment(r)})};return H(()=>Ls(Cs.length,()=>s.value+=1,32)),(r,d)=>{const u=rt,l=j;return c(),p("div",se,[(c(!0),p(F,null,K(n(Cs),(v,b)=>(c(),p("div",{class:O(v.ciass),key:b},[e("div",{class:O([{"ani-card":n(s)>=b},"op-0 mb ani-scaie-aii"])},[a.has(v)?(c(),T(l,{key:0,bk:!0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:f(()=>[e("div",te,[_(u,{class:"mxw-100",code:v.code_icon},null,8,["code"])]),e("p",ie,h(v.tit),1)]),_:2},1024)):(c(),T(l,{key:1,bk:!0,onClick:x=>a.insrt_payment(v),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:f(()=>[e("div",ee,[_(u,{class:"mxw-100",code:v.code_icon},null,8,["code"])]),e("p",oe,h(v.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}});const ae={class:"py-row"},_e={class:"fx-i pi-row"},ce=e("h6",{class:"mxw-3em ta-c"},"小計",-1),re={class:"fw-700"},de={class:"py"},ue={class:"fx-i pi-row"},pe={key:0,class:"pr fx-i"},le=["onUpdate:modelValue"],me={key:1,class:"pr fx-i"},fe={class:"fw-600 ps-r zi-s"},he=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),ve={class:"pi-row"},be=["onUpdate:modelValue"],$e={key:0,class:"ani-fade-b"},ye={key:0,class:"d-ib"},ge=y({__name:"DrnCheckouItems",setup(i){const s=C(),{payments:t}=M(s),o=A({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=z(()=>{let d=0;const u=t.value;return u&&u.map(l=>{d=$.floatAdd(d,l.price)}),d}),r={sureTrash:d=>k(()=>{o.trashIdx=$t(d),U(-210)}),trash:()=>k(()=>{const d=t.value;if(d.length>0&&o.trashIdx>=0){const u=d[o.trashIdx];u&&u.id?s.trash_payment(u):W("刪除項丟失，需重新選區。"),U(0),o.trashIdx=-1}})};return H(()=>Ls(7,()=>o.ani+=1,32)),(d,u)=>{const l=Bt,v=rt,b=tt,x=Ms;return c(),p("div",null,[e("div",ae,[_(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:f(()=>[e("div",_e,[ce,e("h5",re,[w(" :     HKD "),_(as)])])]),_:1})]),e("aside",de,[(c(!0),p(F,null,K(n(t),(m,g)=>(c(),p("div",{key:g},[_(l,{onTrash:D=>r.sureTrash(g),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:f(()=>[e("div",ue,[m.code=="Other"?(c(),p("div",pe,[L(e("input",{class:"mxw-5em","onUpdate:modelValue":D=>m.name=D,placeholder:"自定義名稱"},null,8,le),[[is,m.name]])])):(c(),p("div",me,[_(v,{code:m.code_icon,class:"mxh-2em mxw-5em br-s"},null,8,["code"])])),e("div",fe,[he,e("div",ve,[L(e("input",{type:"number","onUpdate:modelValue":D=>m.price=D,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,be),[[is,m.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(t).length>1?(c(),p("aside",$e,[_(b,{class:"fx-c"},{default:f(()=>[(c(!0),p(F,null,K(n(t),(m,g)=>(c(),p("div",{key:g},[w(h(n(st)(m.price))+" ",1),g<n(t).length?(c(),p("div",ye,"  +  ")):B("",!0)]))),128)),e("div",null," =  "+h(n(N)(n(a))),1)]),_:1})])):B("",!0),_(x,{onTrash:u[0]||(u[0]=m=>r.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),xe={class:"py-row"},we={class:"ta-c"},ke=e("h5",{class:"pb"},"實收金額",-1),Ce={class:"py"},De={class:"txt-money fw-700"},Te={class:"fs-2em"},Pe=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),Ae={class:"fx-c pt"},qe={class:"w-618"},Me=e("p",{class:"py-s"},null,-1),Oe=y({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(i){return(s,t)=>{const o=Z,a=bs;return c(),p("div",xe,[e("div",we,[ke,e("div",Ce,[e("h4",De,[e("div",Te,[w("HKD  "),_(as)])])]),Pe]),e("div",Ae,[e("div",qe,[_(o,{aii:s.aii,onClick:t[0]||(t[0]=r=>s.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),Me,_(a,{onClick:t[1]||(t[1]=r=>s.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),Se="orders",Ie=async i=>{let s="";try{s=yt(await As.pos(Se,i))}catch(t){W("下單失敗！！！"),console.log(t);const o=gt(t);return console.log("errs =",o),o.msg?o.msg:o.message}return s},Be="cashier_products",ze="iabeis",Re=async(i,s)=>Qs(et,async()=>Xs(await As.get(ze,Y.buiid_pager(i,s)))),Ne=async(i,s)=>Qs(et,async()=>Xs(await As.get(Be,Y.buiid_pager(i,s)))),V=Gs("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(i){return i.broken_products=Y.iist(i.broken_products),i.variations=Y.iist(i.variations),i.labels=Y.iist(i.labels),delete i.restocks,i.__broken_products=i.broken_products?i.broken_products.length:0,delete i.broken_products,i.labels=Y.kiii_times(i.labels),i.variations=Y.kiii_times(i.variations),i},async refreshProducts(){let i=await Ne(this.condition,this.pager);return ws(i)?!1:(i=i,this.products=i.data?i.data.map(s=>this.vfy_products(s)):[],!0)},async refreshIabeis(){let i=await Re({},{pageSize:100,page:1});if(!ws(i)){i=i;const s=i.data?i.data:[];if(s.length>0)return this.iabeis=s,!0}return!1},save(i,s={}){this[i]=s},saveMany(i,s=[]){this[i]=s},savePager(i,s){this.pager[i]=s},saveCondition(i,s){this.condition[i]=s},variations(i){const s=i.variations?i.variations:{};return s.data?Y.iist(s):[]}}}),Fe={class:"py-row"},Ee=e("div",{class:"py-x2"},null,-1),Ke=y({__name:"DrnCheckout",setup(i){const s=P(),t=A({ioading:!1,msg:""}),{member:o}=M(s),a=A({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),r={buiid:()=>{const d=s.buiid_ordered_product();if(d.length<=0)return W("結算清單不能為空。"),null;const u=C().buiid_payment_method();if(u.length<=0)return W("請選擇至少一種付款方式。"),null;const l=s.buiid_discount(),v=C().cmoput_payment_totai(),b=s.computed_finai_totai();return R.is_money_same(v,b)?(a.member=o.value.id?o.value.id:"",a.status=zt.status_checkout_def,a.ordered_product=d,a.payment_method=u,a.discount=l,a.can=!0,a):(W("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async d=>{const u=await Ie(d);ws(u)?(xt(u,t),setTimeout(()=>s.save_sts("stating",!1),300),C().save_sts("ioading",!1)):(C().success_order(u),r.status(!1),V().refreshProducts()),V().dorefresh()},submit:()=>k(async()=>{if(a.can=!1,U(0),I(0),!t.ioading){t.ioading=!0,r.status(!0),s.ciear_choise();const d=r.buiid();d&&d.can?await r._submit(d):r.status(!1),setTimeout(()=>t.ioading=!1,400)}}),status:(d=!1)=>{C().save_sts("ioading",d),C().save_sts("stating",d),s.save_sts("stating",d)},back:()=>k(()=>{C().regress_index()})};return(d,u)=>{const l=vs,v=$s;return c(),T(v,null,{default:f(()=>[_(l,{tit:"結算收款"}),e("div",Fe,[_(ne)]),_(ge,{class:"pt pb-x2"}),_(Oe,{aii:n(t),onBack:u[0]||(u[0]=b=>r.back()),onSubmit:u[1]||(u[1]=b=>r.submit()),class:"w-100"},null,8,["aii"]),Ee]),_:1})}}}),He={class:"py-row"},Ue={class:"fx-c drn-cs-con"},Ve={class:"ta-c"},je={class:"fx-c ani-softer"},We={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},Ge={class:"py ani-fade-b"},Je=e("h3",{class:"pb pt-x1"},"收款成功",-1),Le={class:"py"},Qe={class:"fw-700 fs-2em"},Xe={class:"ani-fade-b"},Ye={class:"py-s fx-c ani-fade-b"},Ze={class:"py-s fx-c ani-fade-b"},so=y({__name:"DrnCheckoutSucc",setup(i){const s=wt(),{order_of_success:t}=M(C()),o={cotinueOrder:()=>k(()=>{o.canceiAii()}),printed:()=>k(()=>{const a=t.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const r=s.resolve({path:"/cashier/order_iist/pdf"});window.open(r.href,"_blank")}else W("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{U(0),I(0)},canceiAii:()=>k(()=>{o.before(),P().ciear_carts(),P().ciear_member(),P().ciear_discount(),C().ciear_now_order(),C().regress_index()})};return(a,r)=>{const d=vs,u=Os,l=Z,v=bs,b=$s;return c(),T(b,null,{default:f(()=>[_(d,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",He,[e("div",Ue,[e("div",Ve,[e("h2",null,[e("div",je,[e("div",We,[_(u,{icon:"check"})])])]),e("div",Ge,[Je,e("h4",Le,[e("div",Qe,[w("HKD "),_(as)])])])])])]),e("div",Xe,[e("div",Ye,[_(l,{onClick:r[0]||(r[0]=x=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"完成收銀"})]),e("div",Ze,[_(v,{onClick:r[1]||(r[1]=x=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),to={class:"o-search-biock br ps-r"},io=["placeholder"],eo={class:"middie r-0 o-search-biock-ciose"},oo=y({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(i){return(s,t)=>{const o=Os,a=j;return c(),p("div",to,[L(e("input",{onKeydown:t[0]||(t[0]=kt(r=>s.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":t[1]||(t[1]=r=>s.form[s.pk]=r),placeholder:s.tit?s.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,io),[[is,s.form[s.pk]]]),e("div",eo,[_(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:t[2]||(t[2]=()=>{s.form[s.pk]="",s.$emit("resuit")})},{default:f(()=>[_(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),no={class:"px-x3 py bg-card ta-i w-100"},ao={class:"bb pb"},_o={class:"fx-s pb"},co={class:"w-42 pr"},ro={class:"w-34 pr"},uo={class:"w-24 fx-r"},po={class:"fx-i"},lo={class:"w-42 pr"},mo={class:"w-34 pr"},fo={class:"fw-900"},ho=y({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(i){return(s,t)=>{const o=j;return c(),T(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:f(()=>[e("div",no,[e("div",ao,"客戶姓名:  "+h(s.v.name),1),e("div",_o,[e("div",co,"郵箱:  "+h(s.v.email),1),e("div",ro,"電話號碼:  "+h(s.v.phone_no),1),e("div",uo,"會員編號:  "+h(s.v.member_id),1)]),e("div",po,[e("div",lo,"會員等級:  "+h(n(ms).ievei(s.v)),1),e("div",mo,[w("購買折扣:   "),e("span",fo,h(n(ms).discount(s.v)),1)])])])]),_:1})}}}),vo={class:"desk-right-custom bg-con ps-r br-ti o-h"},bo={class:"div ps-r zi"},$o={class:"py-x3"},yo={class:"ta-c py"},go={key:0,class:"ani-softer"},xo={key:1,class:"ani-softer"},wo={key:0,class:"pt-x3 ani-fade-b"},ko={key:1,class:"ani-softer"},Co={class:"px-x3 py-x2 fx-c"},Do={class:"pt"},To=e("div",{class:"py-x3"},null,-1),Po={key:0,class:"abs-b zi-x3 w-100 py bg-con"},Ao={class:"fx-c pb-x2"},qo={class:"fx-c"},Mo=y({__name:"DrnCustomCon",setup(i){const s=A({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),t=P(),{member:o}=M(t),a={fetch:()=>Ct(s,async()=>Et(s.condition,s.pager)),search:()=>k(()=>{s.condition.search=(s.condition.search+"").trim(),s.condition.search===""?s.many.length=0:a.fetch()}),choise:r=>k(()=>{t.save_member(r),s.many.length=0,s.many.push({})}),reset:()=>k(()=>{t.save_member({}),s.many.length=0}),view:()=>k(()=>{C().switch_r_tab(1),I(202)})};return(r,d)=>{const u=ho,l=oo,v=Ws,b=it,x=Ft;return c(),p("div",vo,[e("div",bo,[e("div",$o,[e("h3",yo,[n(o).id?(c(),p("div",go,"客戶信息")):(c(),p("div",xo,"搜尋客戶"))]),n(o).id?(c(),p("div",wo,[_(u,{v:n(o)},null,8,["v"])])):(c(),p("div",ko,[e("div",Co,[_(l,{onResuit:d[0]||(d[0]=m=>a.search()),class:"w-75 w-50-x w-100-p",form:n(s).condition,pk:"search"},null,8,["form"])]),e("div",Do,[_(v,{aii:n(s)},{default:f(()=>[(c(!0),p(F,null,K(n(s).many,(m,g)=>(c(),p("div",{key:g,class:"pb"},[m.id?(c(),T(u,{key:0,onClick:D=>a.choise(m),v:m},null,8,["onClick","v"])):B("",!0)]))),128)),To]),_:1},8,["aii"])])]))])]),n(o).id?(c(),p("div",Po,[e("div",Ao,[_(b,{class:"w-382 w-50-p",onClick:d[1]||(d[1]=m=>a.view()),tit:"查看全單優惠"})]),e("div",qo,[_(x,{class:"w-382 w-50-p",onClick:d[2]||(d[2]=m=>a.reset()),tit:"重選客戶"})])])):B("",!0)])}}}),Oo={class:"fx-c"},So=e("span",null,"   加載中 ",-1),Io={key:1,class:"oti-con ani-softer"},Bo={key:0,class:"ani-fade-b"},zo=y({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(i){const s=i,t=A({kiii:!!s.aii.ioading,timed:420});return G(()=>s.aii.ioading,o=>{o?t.kiii=!0:setTimeout(()=>t.kiii=!1,t.timed)}),(o,a)=>{const r=ot,d=Kt,u=Ds;return c(),p("div",{class:O(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(t).kiii?(c(),p("div",{key:0,class:O(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",Oo,[_(r,{styie:"def"}),So,_(d)])],2)):(c(),p("div",Io,[o.aii.many&&o.aii.many.length>0?(c(),p("div",Bo,[ts(o.$slots,"default")])):(c(),T(u,{key:1,class:O({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),Ro={class:"co-desk-prod-card bg-con br ani-scaie-aii"},No={class:"mh-8em pt-x1"},Fo={class:"fw-700 eiip-3"},Eo={class:"cdpc-sub fw-700 op-85 pt-s eiip-3"},Ko={class:"pt pb-x1 fw-700"},Ho=y({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(i){return(s,t)=>{const o=j;return c(),p("nav",Ro,[_(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:f(()=>[e("div",No,[e("h5",Fo,h(s.name),1),e("h6",Eo,"編號"+h(s.number),1)]),e("h6",Ko," HKD  "+h(n(st)(s.price)),1)]),_:1})])}}}),Uo={class:"pr pb"},Vo=e("div",{class:"py-x3"},null,-1),jo=y({__name:"DcDoRefreshProduct",setup(i){const s=A({ioading:!1,msg:""}),t=()=>k(async()=>{s.ioading||(s.ioading=!0,await V().refreshProducts()?(us("產品刷新成功。"),await V().refreshIabeis()&&us("標籤刷新成功。")):W("產品刷新失敗！！！"),setTimeout(()=>s.ioading=!1,400))});return(o,a)=>{const r=Ss;return c(),p("div",Uo,[_(r,{class:O([{"ani-cir":n(s).ioading},"h4 bg-con"]),onClick:a[0]||(a[0]=d=>t()),icon:"refresh",ciass_i:"h3"},null,8,["class"]),Vo])}}}),Wo={class:"ps-r"},Go={key:0},Jo={class:"desk-right-cards row row-x2-w pb"},Lo=e("div",{class:"py-row"},null,-1),Qo={key:1,class:"mh-oti fx-c"},Xo=y({__name:"DrnProductsCon",setup(i){const s=V(),{pager:t,condition:o,products:a}=M(s),r=A({ioading:!0,msg:"",many:[{}]});G(t.value,()=>d.fetch()),G(o.value,()=>d.fetch());const d={shop:u=>k(()=>{u.__quantity=0,u.__price=u.new_selling_price,u.__variation=0,s.save("one_of_shop",u),I(501)}),fetch:()=>k(async()=>{r.ioading=!0,await s.refreshProducts(),r.ioading=!1})};return H(d.fetch),(u,l)=>{const v=Ho,b=Ss,x=nt,m=zo;return c(),p("div",Wo,[_(m,{aii:n(r)},{default:f(()=>[n(a).length>0?(c(),p("div",Go,[e("div",Jo,[(c(!0),p(F,null,K(n(a),(g,D)=>(c(),p("div",{class:"w-333-p w-25 w-20-x ani-softer",key:D},[_(v,{class:"w-100 mb-x1",onClick:q=>d.shop(g),name:g.name,number:g.product_id,price:n(N)(g.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Lo])):(c(),p("div",Qo,[_(x,{tit:"無商品數據"},{default:f(()=>[_(b,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=g=>d.fetch())})]),_:1})]))]),_:1},8,["aii"]),_(jo,{class:"abs-b r-0 ps-f-imp zi"})])}}}),Yo={class:"w-50-p w-35 w-30-x ts"},Zo={class:"fx-s pb"},sn={class:"fx-1 fx-i tabs-pri pt"},tn={key:0,class:"fs-s px-s tag"},en=e("div",{class:"ta-r pt"},null,-1),on=y({__name:"DrNormaiiTopTabs",setup(i){const s=C(),{member:t}=M(P()),o=A({tab:0,search:""}),a=()=>k(()=>V().saveCondition("search",o.search)),r=d=>s.switch_r_tab(d);return(d,u)=>{const l=Ht,v=j;return c(),p("aside",null,[e("div",Yo,[_(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:u[0]||(u[0]=b=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",Zo,[e("div",sn,[e("div",{class:O(["tab-item mr",{"tab-iive":n(s).r_tab==0}]),onClick:u[1]||(u[1]=b=>r(0))},[_(v,{class:"px py",bk:!0,ciass:n(s).r_tab==0?"txt-pri":"tit"},{default:f(()=>[w(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:O(["tab-item mr",{"tab-iive":n(s).r_tab==1}]),onClick:u[2]||(u[2]=b=>r(1))},[_(v,{class:"px py",bk:!0,ciass:n(s).r_tab==1?"txt-pri":"tit"},{default:f(()=>[w(" 客戶  "),n(t).id?(c(),p("div",tn,"("+h(n(t).name)+")",1)):B("",!0)]),_:1},8,["ciass"])],2)]),en])])}}}),nn=["id"],an=y({__name:"scroiix",setup(i){const s=Dt();return(t,o)=>{var a;return c(),p("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(s))==null?void 0:a.uid)},[ts(t.$slots,"default",{},void 0,!0)],8,nn)}}});const _n=Js(an,[["__scopeId","data-v-0a9c5a94"]]),cn={class:"desk-center-tats-bar bg-con br pi-row"},rn={class:"ps-r py"},dn={class:"dctb-tags w-100 ps-r"},un=e("button",{class:"py"}," ",-1),pn={class:"fx-i w-100"},ln={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},mn={key:0,class:"px-n"},fn=y({__name:"DrNormaiiTagsBar",setup(i){const s=A({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),t=V(),{iabeis:o}=M(V());return G(()=>s.tag,r=>{t.saveCondition("label",r?r+"":"")}),H({iive:r=>Tt(r,s.tags),fetch:()=>hs(s,async()=>await t.refreshIabeis())}.fetch),(r,d)=>{const u=j,l=ot,v=_n;return c(),p("div",cn,[e("div",rn,[e("div",dn,[un,_(v,{class:"abs-i t-0"},{default:f(()=>[e("div",pn,[_(u,{bk:!0,class:O(["btn-tab py px mw-4em mr br",{"btn-app":n(s).tag==0}]),onClick:d[0]||(d[0]=b=>n(s).tag=0)},{default:f(()=>[w("全部")]),_:1},8,["class"]),n(s).ioading?(c(),p("div",ln,[_(l,{styie:"pri"})])):B("",!0),(c(!0),p(F,null,K(n(o),(b,x)=>(c(),p("div",{key:x},[b.isShow?(c(),p("div",mn,[_(u,{bk:!0,class:O(["btn-tab py px mw-8em br",{"btn-app":n(s).tag==b.id}]),onClick:m=>n(s).tag=b.id},{default:f(()=>[w(h(b.name),1)]),_:2},1032,["onClick","class"])])):B("",!0)]))),128))])]),_:1})])])])}}}),hn={class:"pt ani-fade-b"},vn={class:"pt ani-fade-b"},bn={class:"pt"},$n={class:"pt pi-row ani-fade-b"},yn={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},gn=y({__name:"DrNormaiiWrapper",setup(i){const{r_tab:s}=M(C()),t=A({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=M(V()),a={pager:(r,d)=>k(()=>{o.value.page=r,o.value.pageSize=d,V().save("pager",o.value)})};return(r,d)=>{const u=Nt,l=Rt;return c(),p("div",null,[_(on),L(e("div",hn,[e("aside",null,[_(fn)]),e("div",vn,[_(u,{class:"desk-right-con"},{default:f(()=>[e("aside",bn,[_(Xo)])]),_:1})])],512),[[Rs,n(s)==0]]),L(e("div",$n,[_(Mo)],512),[[Rs,n(s)==1]]),n(s)==0?(c(),p("aside",yn,[_(l,{onResuit:a.pager,pager:n(t).pager},null,8,["onResuit","pager"])])):B("",!0)])}}}),xn={class:"fx-s"},wn={class:"fx-1"},kn={class:"fw-700 ani-softer"},Cn={class:"txt-money d-ib"},Dn={class:"d-ib ani-scaie-aii"},Tn={key:0,class:"fx-r ani-softer"},dt=y({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(i){const s=i,t=z(()=>R.carts_aii_num(s.receipt.carts?s.receipt.carts:[])),o=z(()=>R.computed_finai_totai_for_recept(s.receipt));return(a,r)=>{const d=it;return c(),p("div",null,[e("div",xn,[e("div",wn,[e("h3",kn,[e("span",null,"共"+h(n(t))+"件 ",1),e("div",Cn,[w("  HKD  "),e("div",Dn,h(n(N)(n(o))),1)])])]),a.kiii_option?B("",!0):(c(),p("div",Tn,[_(d,{onClick:r[0]||(r[0]=u=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),Pn={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},An={class:"w-35 pi-row"},qn=e("span",null,"掛單時間:  ",-1),Mn={class:"w-43"},On=e("span",null,"收銀員:  ",-1),Sn={class:"d-ib"},In={class:"w-22"},Bn=e("span",null,"客戶:  ",-1),zn={key:0,class:"d-ib"},Rn={key:1,class:"d-ib txt-err"},ut=y({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(i){const s=i,t=z(()=>s.receipt.member?s.receipt.member:{});return(o,a)=>(c(),p("aside",Pn,[e("div",An,[qn,e("span",null,h(o.receipt.save_time?o.receipt.save_time:n(ls)()),1)]),e("div",Mn,[On,e("div",Sn,h(n(ps)().name),1)]),e("div",In,[Bn,n(t).id?(c(),p("div",zn,h(n(t).name),1)):(c(),p("div",Rn," (未選擇客戶) "))])]))}}),pt="handshake_cashier_receipts",Nn=10,rs=()=>{const i=localStorage.getItem(pt);if(i){const s=JSON.parse(i);return Pt(s)?s:[]}return[]},Vs=i=>{localStorage.setItem(pt,JSON.stringify(i))},Fn=i=>i.length>=Nn,es={has_receipt:(i,s=!1)=>(rs().map(t=>{t.__idx==i.__idx&&(s=!0)}),s),save_receipt:i=>{const s=rs();if(s){if(Fn(s))W("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(i.carts)return i.__idx=s.length,s.push(i),Vs(s),!0}return!1},receipts:()=>rs(),trash_receipt:(i,s=-1)=>{const t=rs();return t&&(t.map((o,a)=>{o.__idx==i.__idx&&(s=a)}),s>=0)?(t.splice(s,1),Vs(t),!0):!1}},En={key:0},Kn={class:"w-26"},Hn={class:"w-20"},Un={class:"w-13"},Vn={class:"w-13"},jn={class:"w-14"},Wn={class:"w-14"},Gn={key:1,class:"mh-oti-s fx-c"},lt=y({__name:"DrnRbTabie",props:{receipt:{}},setup(i){const s=A({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t={vai_totai:o=>N(P().comput_one_totai(o))};return H(()=>os(s,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const r=nt,d=fs;return c(),T(d,{aii:n(s),mini:!0},{default:f(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),p("div",En,[(c(!0),p(F,null,K(o.receipt.carts,(u,l)=>(c(),p("div",{class:"td",key:l},[e("div",Kn,h(u.__product.name),1),e("div",Hn,h(u.__variation.name),1),e("div",Un,"- "+h(u.discount_deduction),1),e("div",Vn,h(u.__product.new_selling_price),1),e("div",jn,h(u.quantity),1),e("div",Wn,h(t.vai_totai(u)),1)]))),128))])):(c(),p("div",Gn,[_(r,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),Jn={class:"py-row"},Ln=e("div",{class:"pt"},null,-1),Qn={class:"py-row"},Xn={key:0,class:"py-x3 fx-c"},Yn={key:1,class:"py-x3 ani-fade-b"},Zn={class:"pb-row fx-c"},sa={class:"fx-c ani-fade-b"},ta=y({__name:"DrnRetainBiiis",setup(i){const s=P(),{saving:t}=M(C()),{carts:o,member:a,ratio_of_member:r,ratio_of_aii:d,discount_of_aii:u}=M(s),l=A({ioading:!1,msg:""}),v=z(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:d.value,discount_of_aii:u.value,ratio_of_member:r.value})),b={back:()=>k(()=>{C().regress_index()}),__save:()=>{l.ioading=!0;const x=v.value;x.save_time=ls();const m=es.save_receipt(x);return setTimeout(()=>l.ioading=!1,200),m?(At("單據保存成功。",l),C().save_sts("saving",!0),!0):!1},save_receipt:()=>k(b.__save),ciear_order:()=>{U(0),I(0),P().ciear_carts(),P().ciear_member(),P().ciear_discount(),C().ciear_now_order()},save_receipt_than_ciear_order:()=>k(async()=>{b.__save()&&(b.ciear_order(),C().regress_index())})};return(x,m)=>{const g=vs,D=ut,q=dt,S=Ts,E=Ut,J=Z,_s=bs,ss=$s;return c(),T(ss,null,{default:f(()=>[_(g,{tit:"保留單據"}),e("div",Jn,[_(S,{class:"py-row px-row"},{default:f(()=>[Ln,_(D,{receipt:n(v)},null,8,["receipt"]),e("div",Qn,[_(lt,{receipt:n(v),class:"py-s"},null,8,["receipt"])]),_(q,{receipt:n(v),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(t)?(c(),p("div",Xn,[_(E,{class:"w-382 w-50-p",onClick:m[0]||(m[0]=cs=>b.back()),tit:"返回"})])):(c(),p("div",Yn,[e("div",Zn,[_(J,{aii:n(l),class:"w-382 w-50-p",onClick:m[1]||(m[1]=cs=>b.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",sa,[_(_s,{class:"w-382 w-50-p",onClick:m[2]||(m[2]=cs=>b.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),ia={key:0,class:"py-row ani-softer"},ea={class:"pt abs-r t-0 zi pr"},oa=e("div",{class:"pt-x2"},null,-1),na={class:"py-row"},aa={key:1,class:""},_a={key:0,class:"py-x3 fx-c ani-fade-b"},ca=y({__name:"DrnRecaptionBiiis",setup(i){const s=A({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t=A({receipt:{},receipt_of_trash:{}}),o={reorder:a=>k(()=>{t.receipt=a,U(101)}),do_reorder:()=>k(()=>{s.ioading=!0;const{carts:a,member:r,ratio_of_aii:d,ratio_of_member:u,discount_of_aii:l}=t.receipt;P().doReceiptToOrder(a,r,d,u,l),C().regress_index(),us("單據取回成功。"),es.trash_receipt(t.receipt),setTimeout(()=>s.ioading=!1,200)}),fetch:()=>k(()=>{s.ioading=!0,s.many=es.receipts(),setTimeout(()=>s.ioading=!1,200)}),trash_receipt:()=>k(()=>{s.ioading||(s.ioading=!0,U(0),es.trash_receipt(t.receipt_of_trash)?(us("單據刪除成功。"),s.many.length=0,s.many=es.receipts()):W("單據刪除失敗！！！"),setTimeout(()=>s.ioading=!1,200))}),sureTrash:a=>k(()=>{U(-301),t.receipt_of_trash=a}),ciose:()=>k(()=>{C().switch_r_page(0)})};return H(o.fetch),(a,r)=>{const d=vs,u=Wt,l=ut,v=dt,b=Ts,x=Ds,m=Ws,g=bs,D=Ms,q=jt,S=$s;return c(),T(S,null,{default:f(()=>[_(d,{tit:"取回單據",num:n(s).many.length},null,8,["num"]),_(m,{aii:n(s)},{default:f(()=>[n(s).many&&n(s).many.length>0?(c(),p("div",ia,[(c(!0),p(F,null,K(n(s).many,(E,J)=>(c(),p("div",{class:"pb-x2",key:J},[_(b,{class:"py-row px-row ps-r"},{default:f(()=>[e("div",ea,[_(u,{onClick:_s=>o.sureTrash(E)},null,8,["onClick"])]),oa,_(l,{receipt:E},null,8,["receipt"]),e("div",na,[_(lt,{receipt:E,class:"py-s"},null,8,["receipt"])]),_(v,{onReorder:o.reorder,receipt:E},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),p("div",aa,[_(x,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(s).many.length<=0?(c(),p("div",_a,[_(g,{onClick:r[0]||(r[0]=E=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):B("",!0),_(D,{idx:-301,aii:n(s),onTrash:r[1]||(r[1]=E=>o.trash_receipt())},null,8,["aii"]),_(q,{idx:101,aii:n(s),onSure:r[2]||(r[2]=E=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),ra={class:"ps-r"},da=y({__name:"DeskRight",setup(i){const{r_page:s}=M(C());return(t,o)=>(c(),p("div",ra,[n(s)==0?(c(),T(gn,{key:0})):n(s)==3?(c(),T(ta,{key:1})):n(s)==4?(c(),T(ca,{key:2})):n(s)==100?(c(),T(Ke,{key:3})):n(s)==101?(c(),T(so,{key:4})):B("",!0)]))}}),ua={class:"o-number-manager-two"},pa={class:"fx-c"},la={class:"px ta-c py-x1 ani-scaie-hv"},ma={class:"fx-c"},fa=y({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{},max_tit:{},min:{},min_tit:{}},setup(i){const s=i,t=()=>s.form[s.pk],o={setv:a=>{s.form[s.pk]=a},min:()=>{if(s.disabied)return 0;let a=t()-1;const r=s.min?s.min:0;a=a<=r?r:a,a==r&&s.min_tit&&Ns(s.min_tit+""),o.setv(a)},add:()=>{if(s.disabied)return 0;let a=t()+1;s.max!=null&&(a=a>s.max?s.max:a,a==s.max&&s.max_tit&&Ns(s.max_tit+"")),o.setv(a)},effect:()=>{s.max!=null&&t()>s.max&&o.setv(s.max>0?s.max:0)}};return Ys(o.effect),(a,r)=>{const d=Os,u=j;return c(),p("div",ua,[e("div",pa,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:r[0]||(r[0]=l=>o.add()),ciass:"fx-c"},{default:f(()=>[_(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",la,h(a.form[a.pk]?a.form[a.pk]:0),1),e("div",ma,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:r[1]||(r[1]=l=>o.min()),ciass:"fx-c"},{default:f(()=>[_(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),ha={class:"w-100 ani-softer"},X=y({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(i){return(s,t)=>{const o=j;return c(),p("div",ha,[_(o,{bk:!0,onClick:t[0]||(t[0]=a=>s.$emit("tap")),class:O([{"btn-die-imp":s.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:f(()=>[ts(s.$slots,"default")]),_:3},8,["class"])])}}}),va={class:"desk-center pt"},ba=e("div",{class:"py"},null,-1),$a={key:0,class:"o-form pt-row ani-fade-b"},ya=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ga=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),xa=y({__name:"DeskCenter",setup(i){const{stating:s}=M(C()),t=P(),{has_choise:o,carts:a,choiseOne:r}=M(t),d=z(()=>o&&a.value.length>0&&r.value.product),u=z(()=>a.value.length>0),l=A({now:0,num:0,ani:0,ioading:!1,msg:""}),v={opt:x=>k(()=>{if(!s.value)switch(x){case 1:I(201);break;case 2:I(202);break;case 5:C().switch_r_page(3),C().uniock_ieft();break;case 10:I(207);break;case 110:P().remove_cart();break;case 111:U(-201);break;case 120:v.backReceipt();break;default:l.now=0,C().switch_r_page(0),C().uniock_ieft();break}}),canceiAii:()=>k(()=>{U(0),I(0),P().ciear_carts(),P().ciear_member(),P().ciear_discount(),C().ciear_now_order(),C().regress_index()}),backReceipt:()=>k(()=>{C().uniock_ieft(),C().switch_r_page(4)})},b=z((x=0)=>{try{const m=r.value?r.value:{},g=ps().mystore;x=R.ioc_inventory(m,g,m.variation)}catch{}return x});return G(r,(x={})=>{console.log(x);const m=x.quantity?x.quantity:0,g=x.__product?x.__product:{};if(m==0&&g.id){const D=g.name?(g.name+"").trim():"",q=g.product_id;qt("產品數量為 0，自動移出購物清單。"+(D?`產品編號：${q}`:""));const S=t.choiseOneIndex;t.switch_cart_choise(S),t.remove_cart(S)}},{deep:!0}),(x,m)=>{const g=fa,D=Ms;return c(),p("div",va,[_(g,{disabied:n(s),max_tit:"已到達產品最大庫存數量，無法再增加數量。",max:n(b),class:"ani-item",form:n(r),pk:"quantity"},null,8,["disabied","max","form"]),ba,n(u)?(c(),p("div",$a,[n(d)?(c(),T(X,{key:0,onTap:m[0]||(m[0]=q=>v.opt(1))},{default:f(()=>[w(" 單品優惠 ")]),_:1})):(c(),T(X,{key:1,disabied:!0},{default:f(()=>[w(" 單品優惠 ")]),_:1})),ya,_(X,{onTap:m[1]||(m[1]=q=>v.opt(2))},{default:f(()=>[w(" 全單優惠 ")]),_:1}),_(X,{onTap:m[2]||(m[2]=q=>v.opt(10))},{default:f(()=>[w(" 統計毛利率 ")]),_:1}),_(X,{onTap:m[3]||(m[3]=q=>v.opt(5))},{default:f(()=>[w(" 保留單據 ")]),_:1}),ga,n(d)?(c(),T(X,{key:2,onTap:m[4]||(m[4]=q=>v.opt(110))},{default:f(()=>[w(" 單件取消 ")]),_:1})):(c(),T(X,{key:3,disabied:!0},{default:f(()=>[w(" 單件取消 ")]),_:1})),_(X,{onTap:m[5]||(m[5]=q=>v.opt(111))},{default:f(()=>[w(" 整單取消 ")]),_:1})])):B("",!0),_(X,{class:"ani-softer",onTap:m[6]||(m[6]=q=>v.opt(120))},{default:f(()=>[w(" 取回單據 ")]),_:1}),_(D,{aii:n(l),idx:-201,onTrash:m[7]||(m[7]=q=>v.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),mt=y({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(i,{expose:s}){const t=i,{PAN:o}=M(Mt()),a=A({iive:!1,kiii:!1,animeTime:132}),r={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,I(t.idx_end?t.idx_end:0)}};return s(r),G(()=>a.iive,d=>{d?a.kiii=!0:setTimeout(r.kiii,a.animeTime)}),G(o,()=>Ot(t.idx,r.open,r.ciose)),(d,u)=>n(a).kiii?(c(),p("div",{key:0,class:O(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:O(["fixpan-hui",{"fixpan-hui-die":!d.need_hui}]),onClick:u[0]||(u[0]=(...l)=>r.ciose&&r.ciose(...l))},null,2),e("nav",{class:O(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":d.big,"fixpan-main-huge":d.huge}])},[ts(d.$slots,"default")],2)],2)):B("",!0)}}),wa=(i={})=>i.ordered_product?i.ordered_product:[],ka=(i={})=>i.storehouse_info?i.storehouse_info:[],Ca={storehouses:ka,inventory_of_store:(i,s=0)=>((i.variation?i.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s),quatitys_of_variation_in_store:(i,s,t=0,o=0)=>{for(let a=0;a<i.length;a++){const r=i[a],d=r.storehouse_id;t?d==t&&r.variation.map(l=>{l.id==s&&(o+=l.quantity)}):r.variation.map(l=>{l.id==s&&(o+=l.quantity)})}return o},order_products:wa},Da={class:"py pi"},Ta=e("h4",{class:"pt-x3"},"選擇",-1),Pa={class:"py-x2"},Aa=e("option",{value:"0"},"-- 請選擇 --",-1),qa=["value"],Ma={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},Oa={class:"ani-softer d-ib"},Sa={key:0,class:"ani-softer d-ib"},Ia={key:1,class:"sus"},Ba={class:"pt"},za={class:"pb-x3 pt"},Ra={class:"py-x3"},Na=e("div",{class:"pb"},"購買數量",-1),Fa={class:"txt-pri bb pt-x2 pb"},Ea=y({__name:"DrnProdMsgPan",setup(i){const s=V(),{one_of_shop:t}=M(s),o=A({ioading:!1,msg:""});H(()=>k(()=>{ps().mystore==0&&W("該收銀員未綁定倉庫！！！")}));const a=()=>k(async()=>{t.value.id&&I(502)}),r=z(()=>Ca.storehouses(t.value)),d=z((m=0)=>{const g=t.value.__variation;return x().map(D=>{D.id&&D.id==g&&(m=D.quantity)}),m<0?0:m}),u=z(()=>d.value-P().cartQuantity(t.value.id)),l=z(()=>(t.value.__variation||t.value.__variation<=0)&&d.value<=0),v=A(qs({__variation:"",__quantity:"",__price:""})),b=()=>hs(o,async()=>{const m=t.value,g=m.__variation,D=m.__quantity,q=m.__price;for(let J in v)v[J]=!1;if(g<=0){v.__variation=!0;return}if(D<=0){v.__quantity=!0;return}if(q<0){v.__price=!0;return}const S=m.variations;let E={};S.map(J=>{J.id==g&&(E=J)}),P().add_cart(m,D,E),I(0)}),x=()=>{let m=[];const g=ps().mystore;return r.value.map(D=>{D.storehouse_id==g&&(m=D.variation?D.variation:[])}),m};return(m,g)=>{const D=at,q=Bs,S=Gt,E=Z,J=ns,_s=mt;return c(),T(_s,{idx:501,idx_end:0},{default:f(()=>[_(J,{tit:"加入購物清單"},{default:f(()=>[e("div",Da,[_(D,{num:n(t).product_id,named:n(t).name},null,8,["num","named"])]),Ta,e("div",Pa,[_(q,{tit:"客人需要的樣式",err:n(v).__variation},{default:f(()=>[L(e("select",{"onUpdate:modelValue":g[0]||(g[0]=ss=>n(t).__variation=ss)},[Aa,(c(!0),p(F,null,K(n(t).variations,(ss,cs)=>(c(),p("option",{key:cs,value:ss.id},h(ss.name),9,qa))),128))],512),[[St,n(t).__variation]])]),_:1},8,["err"])]),e("div",Ma,[n(t).__variation?(c(),p("p",{key:0,class:O(["",{"txt-err":n(l)}])},[e("div",Oa,h(n(u)),1),w("  件庫存 "),n(u)==0?(c(),p("div",Sa,"(缺貨)")):B("",!0)],2)):(c(),p("p",Ia,"沒有庫存信息，請先選擇一個樣式")),e("p",Ba,h(n(N)(n(t).__price))+" HKD",1)]),e("div",za,[e("div",Ra,[Na,_(S,{err:n(v).__quantity,form:n(t),max:n(u),pk:"__quantity"},null,8,["err","form","max"])]),e("div",Fa,[e("span",{onClick:g[1]||(g[1]=ss=>a())},"庫存明細")])]),_(E,{aii:n(o),onClick:g[2]||(g[2]=ss=>b()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),Ka={class:"ps-r"},Ha={class:"expan-icon middie abs-r fx-i zi"},Ua={class:"expan-inner"},Va=y({__name:"expan",props:{def:{type:Boolean}},setup(i){const s=i,t=A({show:s.def?s.def:!1});return G(()=>s.def,o=>t.show=o),(o,a)=>{const r=Ss;return c(),p("div",{class:O(["",{"expan-iive":n(t).show,"expan-die":!n(t).show}])},[e("div",Ka,[e("div",null,[ts(o.$slots,"tit")]),e("div",Ha,[_(r,{onClick:a[0]||(a[0]=d=>n(t).show=!n(t).show),icon:"c-r"})])]),e("div",Ua,[ts(o.$slots,"con")])],2)}}}),ja={class:"td"},Wa={class:"w-20"},Ga={class:"w-20"},Ja={class:"fx-1 fx-s sus"},La={class:"fx-i ani-fade-b"},Qa=e("div",{class:"w-19"},null,-1),Xa={class:"fx-1"},Ya={class:"td tr-bg"},Za={class:"w-36"},s_={class:"fx-1"},t_=y({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(i){const s=i;H(()=>os(s.aii,Jt));const t={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(t.buiid_variation(o).map(d=>{a+=d.quantity?d.quantity:0}),a)};return(o,a)=>{const r=Va,d=fs;return c(),T(d,{aii:o.aii,mini:!0},{default:f(()=>[(c(!0),p(F,null,K(o.one_of_edit.storehouse_info,(u,l)=>(c(),p("div",{key:l},[_(r,{def:!0},{tit:f(()=>[e("div",ja,[e("div",Wa,h(u.storehouse_name),1),e("div",Ga,h(t.one_quantity_totai(u)),1),e("div",Ja,h(u.storehouse_address),1)])]),con:f(()=>[e("div",La,[Qa,e("div",Xa,[(c(!0),p(F,null,K(t.buiid_variation(u),(v,b)=>(c(),p("div",{class:"ani-fade-b",key:b},[e("div",Ya,[e("div",Za,"樣式:  "+h(v.name),1),e("div",s_,"庫存:  "+h(v.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),i_={class:"py-x3 mt fx-c"},e_=y({__name:"DrnProdInvenPan",setup(i){const s=V(),{one_of_shop:t}=M(s),o=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(r,d)=>{const u=Vt,l=t_,v=Z,b=ns,x=mt;return c(),T(x,{idx:502,big:!0,idx_end:501},{default:f(()=>[_(b,{tit:"庫存詳情",ciass:"px"},{default:f(()=>[_(u,{product:n(t),class:"mb"},null,8,["product"]),_(Lt,{one_of_edit:n(t),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),_(l,{class:"mh-20em",one_of_edit:n(t),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",i_,[_(v,{class:"w-382 w-50-p",tit:"關閉",onClick:d[0]||(d[0]=m=>n(I)(501))})])]),_:1})]),_:1})}}}),o_=i=>i>1||i<0||!i?1:i,ft={vfy_ratio:o_},n_={class:"py pi"},a_={class:"pi-row"},__={class:"pi"},c_={class:"pi py-s"},r_={class:"pi py-s"},d_={class:"py-x3"},u_={class:"fx-i"},p_={key:0,class:"py-x3"},l_=e("h6",{class:"pb"}," 單品折扣 ",-1),m_={key:1,class:"py-x3"},f_=e("h6",{class:"pb"}," 單品減價 ",-1),h_={class:""},v_=e("h6",null,"計算  ",-1),b_={class:"pi pt-x2"},$_={class:"fx-i pi-row"},y_=e("p",null,"=  ",-1),g_=e("div",{class:"py-x3"},null,-1),x_=y({__name:"DeskCenterDiscountPan",setup(i){const s=P(),{choiseOne:t}=M(s),o=z(()=>t.value.__product?t.value.__product:{}),a=A(qs({discount:""}));G(()=>t.value.discount,u=>{const l=s.comput_one_totai(t.value);t.value.is_ratio||(l<=0?(t.value.discount=s.comput_num_x_price(t.value),a.discount=!0):a.discount=!1)});const r={price:()=>{const u=o.value;return u.new_selling_price?u.new_selling_price:0},submit:()=>hs(d,async()=>{I(0)}),switchMod:u=>k(()=>{t.value.is_ratio=u,u?t.value.discount=1:t.value.discount=0,a.discount=!1}),vfy:()=>{t.value.is_ratio&&(t.value.discount=ft.vfy_ratio(t.value.discount))}},d=A({nows:[0],now:0,ioading:!1,msg:""});return(u,l)=>{const v=at,b=j,x=Bs,m=Z,g=ns,D=Is;return c(),T(D,{idx:201},{default:f(()=>[_(g,{tit:"單品優惠"},{default:f(()=>[e("div",null,[e("div",n_,[_(v,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",a_,[e("div",__,"商品單價:  "+h(r.price()),1),e("div",c_,"購買數量:  "+h(n(t).quantity),1),e("div",r_,[w("單品總價:   "),e("div",{class:O(["d-ib",{"txt-money":!n(s).comput_num_x_price(n(t))}])}," HKD "+h(n(N)(n(s).comput_num_x_price(n(t)))),3)])]),e("div",d_,[e("div",u_,[_(b,{bk:!0,onClick:l[0]||(l[0]=q=>r.switchMod(!1)),class:O([{"btn-pri":!n(t).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:f(()=>[w("單品減價")]),_:1},8,["class"]),_(b,{bk:!0,onClick:l[1]||(l[1]=q=>r.switchMod(!0)),class:O([{"btn-pri":n(t).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:f(()=>[w("單品折扣")]),_:1},8,["class"])])]),n(t).is_ratio?(c(),p("div",p_,[l_,_(x,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:f(()=>[L(e("input",{type:"number",onBlur:l[2]||(l[2]=q=>r.vfy()),"onUpdate:modelValue":l[3]||(l[3]=q=>n(t).discount=q),placeholder:"請輸入要打折的折扣數值"},null,544),[[is,n(t).discount]])]),_:1},8,["err"])])):(c(),p("div",m_,[f_,_(x,{tit:"減價金額（正數）",err:n(a).discount},{default:f(()=>[L(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=q=>n(t).discount=q),placeholder:"請輸入要減去的價格"},null,512),[[is,n(t).discount]])]),_:1},8,["err"])])),e("div",h_,[v_,e("div",b_,[e("div",$_,[e("p",null,h(n(s).comput_num_x_price(n(t)))+"  ",1),e("p",null,h(n(t).is_ratio?"x":"-")+"  ",1),e("p",null,h(n(t).discount)+"  ",1),y_,e("p",null,h(n(s).comput_one_totai(n(t))),1)])])]),g_,_(m,{aii:n(d),onClick:r.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),w_={class:"pi"},k_={class:"fx-i"},C_={key:0},D_={class:"px"},T_={key:1,class:"pi fx-i"},P_=e("div",{class:"pr"},"(無會員)",-1),A_={key:0,class:"pt"},q_={class:"pt-s"},M_={class:"d-ib fw-900"},O_={key:1,class:"pt"},S_=e("p",null,"會員等級:  (無會員)",-1),I_=e("p",{class:"pt-s"},"等級折扣:  ",-1),B_=[S_,I_],z_=y({__name:"DcMemberDiscount",setup(i){const s=P(),{member:t,ratio_of_member:o}=M(s),a={findMember:()=>k(()=>{I(0),C().switch_r_tab(1)})};return(r,d)=>{const u=Qt,l=j;return c(),p("div",w_,[e("div",k_,[_(u,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),p("div",C_,[e("div",D_,h(n(t).name),1)])):(c(),p("div",T_,[P_,_(l,{bk:!0,onClick:d[0]||(d[0]=v=>a.findMember()),class:"px py-s btn-weak br-s"},{default:f(()=>[w("查找會員")]),_:1})]))]),n(o).iive?(c(),p("div",A_,[e("p",null,"會員等級:  "+h(n(ms).ievei(n(t))),1),e("p",q_,[w("等級折扣:  "),e("div",M_,h(n(ms).discount(n(t))),1)])])):(c(),p("div",O_,B_))])}}}),R_={class:"py-x3"},N_=e("h6",null,"會員優惠",-1),F_={class:"pt-x2 pi-row"},E_={class:"pt pb-x3"},K_={class:"fx-s"},H_=e("span",{class:"pr"},"全單折扣",-1),U_=["disabled"],V_={class:"pt pb-x3"},j_={class:"fx-s"},W_=e("span",{class:"pr"},"全單減價",-1),G_=["disabled"],J_={class:"py-x3 h6 fw-600"},L_=e("div",{class:"d-ib sus"},"優惠金額",-1),Q_={class:"pt-row"},X_=e("div",{class:"d-ib"},"統計金額",-1),Y_={class:"d-ib txt-money"},Z_=e("div",{class:"py-x2"},null,-1),sc=y({__name:"DeskCenterAiiDiscountPan",setup(i){const s=P(),{choiseOne:t,ratio_of_aii:o,discount_of_aii:a}=M(s),r=z(()=>t.value.__product?t.value.__product:{}),d=A(qs({discount:""})),u={price:()=>{const v=r.value;return v.new_selling_price?v.new_selling_price:0},submit:()=>hs(l,async()=>{I(0)}),vfy:()=>k(()=>{o.value.is_ratio&&(o.value.discount=ft.vfy_ratio(o.value.discount))})},l=A({ioading:!1,msg:""});return(v,b)=>{const x=j,m=Bs,g=Z,D=ns,q=Is;return c(),T(q,{idx:202},{default:f(()=>[_(D,{tit:"全單優惠"},{default:f(()=>[e("div",R_,[N_,e("div",F_,[_(z_)])]),e("div",E_,[e("h6",K_,[H_,n(o).iive?(c(),T(x,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:b[1]||(b[1]=S=>n(o).iive=!1)},{default:f(()=>[w(" 撤銷 ")]),_:1})):(c(),T(x,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:b[0]||(b[0]=S=>n(o).iive=!0)},{default:f(()=>[w(" 啟用 ")]),_:1}))]),_(m,{tit:"折扣率（0 - 1 之間的數字）",err:n(d).discount,class:O({"o-input-err":!n(o).iive})},{default:f(()=>[L(e("input",{type:"number",class:"fw-900",onBlur:b[2]||(b[2]=S=>u.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":b[3]||(b[3]=S=>n(o).discount=S),placeholder:"請輸入要打折的折扣數值"},null,40,U_),[[is,n(o).discount]])]),_:1},8,["err","class"])]),e("div",V_,[e("h6",j_,[W_,n(a).iive?(c(),T(x,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:b[5]||(b[5]=S=>n(a).iive=!1)},{default:f(()=>[w(" 撤銷 ")]),_:1})):(c(),T(x,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:b[4]||(b[4]=S=>n(a).iive=!0)},{default:f(()=>[w(" 啟用 ")]),_:1}))]),_(m,{tit:"減價金額（正數）",err:n(d).discount,class:O({"o-input-err":!n(a).iive})},{default:f(()=>[L(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":b[6]||(b[6]=S=>n(a).discount=S),placeholder:"請輸入要減去的價格"},null,8,G_),[[is,n(a).discount]])]),_:1},8,["err","class"])]),e("div",J_,[e("div",null,[L_,w(":  HKD "),_(ct)]),e("div",Q_,[X_,e("div",Y_,[w(":  HKD "),_(as)])])]),Z_,_(g,{aii:n(l),onClick:u.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),tc={class:"tabie tabie-def"},ic={class:"td"},ec={class:"w-100"},oc=y({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(i){const s=A({trs:[]});return H(()=>os(s,[{ciass:"w-100",tit:"總毛利率"}])),(t,o)=>{const a=zs;return c(),p("div",tc,[_(a,{aii:n(s)},null,8,["aii"]),e("div",ic,[e("div",ec,"HKD "+h(n(N)(t.totai)),1)])])}}}),nc={class:"tabie tabie-def"},ac={class:"td"},_c={class:"w-100"},cc=y({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(i){const s=A({trs:[]});return H(()=>new Promise(t=>{s.trs.length=0,Zs([{ciass:"w-100",tit:"統計金額"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=zs;return c(),p("div",nc,[_(a,{aii:n(s)},null,8,["aii"]),e("div",ac,[e("div",_c,"HKD "+h(n(N)(t.totai)),1)])])}}}),rc={class:"tabie tabie-def"},dc={key:0},uc={class:"w-24"},pc={class:"fx-1"},lc={key:1,class:"td"},mc=e("div",{class:"fx-1"},"(未有任何條目)",-1),fc=[mc],hc=y({__name:"CoSpriTypeTabie",props:{many:{}},setup(i){const s=A({trs:[]});return H(()=>new Promise(t=>{s.trs.length=0,Zs([{ciass:"w-100",tit:"優惠類別"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=zs;return c(),p("div",rc,[_(a,{aii:n(s)},null,8,["aii"]),t.many&&t.many.length>0?(c(),p("div",dc,[(c(!0),p(F,null,K(t.many,(r,d)=>(c(),p("div",{class:"td",key:d},[e("div",uc,h(r.type),1),e("div",pc,"-"+h(n(N)(r.discount_deduction))+" HKD",1)]))),128))])):(c(),p("div",lc,fc))])}}}),vc={class:"w-20"},bc={class:"w-15"},$c={class:"w-12"},yc={class:"w-11"},gc={class:"w-11"},xc={class:"w-9"},wc={class:"w-13"},kc={class:"fx-1 fx-r"},Cc=y({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(i){const s=i,t=P();return H(()=>os(s.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const r=fs;return c(),T(r,{aii:o.aii,mini:!0},{default:f(()=>[(c(!0),p(F,null,K(o.many,(d,u)=>(c(),p("div",{class:"td",key:u},[e("div",vc,h(n(R).product_name(d)),1),e("div",bc,h(n(R).variation(d)),1),e("div",$c,"-"+h(n(N)(n(t).comput_one_discount(d))),1),e("div",yc,h(n(R).product_price(d)),1),e("div",gc,h(n(R).proudct_price_restock(d)),1),e("div",xc,h(d.quantity),1),e("div",wc,h(n(N)(n(t).comput_num_x_price(d))),1),e("div",kc,h(n(N)(n(t).comput_one_profit(d))),1)]))),128))]),_:1},8,["aii"])}}}),Dc={class:"pt-row"},Tc=e("div",{class:"py-row"},null,-1),Pc=e("div",{class:"py-row"},null,-1),Ac=e("div",{class:"py-row"},null,-1),qc=e("div",{class:"py-row"},null,-1),Mc={class:"fx-c py-x3"},Oc=y({__name:"DeskCenterProfitratePan",setup(i){const s=P(),{carts:t}=M(s),o=A({discounts:[],totai_price:0}),a=z((u=0)=>{const l=s.comput_aii_order_discount(s.comput_carts_totai());let v=t.value;return v&&v.length>0&&v.map(b=>{u=$.floatAdd(s.comput_one_profit(b),u)}),$.floatAdd(u,-l)}),r={init:()=>k(()=>{const u=s.buiid_discount();o.discounts=u||[];const l=s.computed_finai_totai();o.totai_price=l})};G(t,r.init),Ys(r.init);const d=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(u,l)=>{const v=Cc,b=hc,x=cc,m=oc,g=Z,D=ns,q=Is;return c(),T(q,{idx:207,big:!0},{default:f(()=>[_(D,{tit:"統計毛利率"},{default:f(()=>[e("div",Dc,[_(v,{many:n(t),aii:n(d)},null,8,["many","aii"]),Tc,_(b,{many:n(o).discounts},null,8,["many"]),Pc,_(x,{totai:n(o).totai_price},null,8,["totai"]),Ac,_(m,{totai:n(a)},null,8,["totai"])]),qc,e("div",Mc,[_(g,{onClick:l[0]||(l[0]=S=>n(I)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),Sc=y({__name:"DeskPans",setup(i){return(s,t)=>(c(),p("div",null,[_(Ea),_(e_),_(x_),_(sc),_(Oc)]))}}),Ic=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Bc={class:"fx-s fx-t w-100 ps-r"},zc={class:"w-82-p w-86 w-88-x"},Rc=y({__name:"desk",setup(i){const{checking:s,ioading:t}=M(C()),{carts:o}=M(P());return H(()=>k(()=>{I(0),U(0)})),(a,r)=>{const d=vt,u=js,l=ht;return c(),p(F,null,[_(l,{compact:!0,mitting:n(s),ioading:n(t)},{ieft:f(()=>[_(d,{tit:"結帳清單 ("+n(o).length+")"},{default:f(()=>[_(ki),Ic]),_:1},8,["tit"])]),ieft_bottom:f(()=>[_(Fi)]),right:f(()=>[e("div",Bc,[_(u,{class:"w-18-p w-14 w-12-x px py"},{default:f(()=>[_(xa)]),_:1}),e("div",zc,[_(da,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),w(),_(Sc)],64)}}});typeof Fs=="function"&&Fs(Rc);export{Rc as default};
